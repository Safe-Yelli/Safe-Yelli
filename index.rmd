---
title: "Mapping harassment in Yelahanka"
//date: "19/10/2021"
output:
  html_document: 

    toc: yes
    toc_float: yes
    toc_depth: 2
    code_folding: hide
    code_download: no

---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(sf)
library(leaflet)
library(leaflet.providers)
library(leaflet.extras)
library(metathis)
library(rgdal)
library(sp)
library(htmltools)
```

```{r}
meta() %>%
  meta_description(
    "Report harassment, assault and catcalling in Yelahanka anonymously"
  ) %>% 
  meta_name("github-repo" = "rungdung/Harassment-in-Yelli") %>% 
  meta_viewport() %>% 
  meta_social(
    title = "Report harassment in Yelahanka anonymously",
    url = "https://safeyelli.netlify.app",
    og_type = "website",
    twitter_card_type = "summary",
    twitter_creator = ""
  )
```
<div class="first-view">

A citizen centric tool to report harassment and assault inside Yelahanka. Visualise your community's citizen reported crime data on a map.



```{r reading data, include=FALSE}
oldHarassData <- read_csv('assets/formResponses2.csv')
#oldHarassData <- oldHarassData %>% separate(., col = `What are the exact coordinates of the incident?`, into = c("Location.lat", "Location.lon"), sep = "\\,")

newHarassData <-read_csv('assets/ushahidiResponses2.csv')

mapUrl="https://api.mapbox.com/styles/v1/rungdung/cku6gh76r1dvh17o3zkfllvjz/tiles/256/{z}/{x}/{y}@2x?access_token=pk.eyJ1IjoicnVuZ2R1bmciLCJhIjoiY2tqeWh6cXF4MDgzMjJvbWVmbGQzYjAwMyJ9.U-aJyoqyKvTXlhVk43jV1A"
```


# See crime reports on maps here {.tabset}

```{r reading other stuff, include=FALSE}

# Read KML file's layers into separate objects
st_layers("assets/hotspots.kml")
shopPlot = readOGR("assets/hotspots.kml", layer="Shops")
emptyPlot = readOGR("assets/hotspots.kml", layer="Empty plots")
infrasPlot = readOGR("assets/hotspots.kml", layer="Dilipated public infrastructure")

# Convert year to field
#harassCoords <- harassCoords %>% mutate(`Year of Occurence`=as.Date(`Year of Occurence`))
#shared_data <- SharedData$new(harassCoords)
#filter_slider("date", "Date", shared_data, ~`Year of Occurence`) # not working yet 
# https://stackoverflow.com/questions/62849300/r-leaflet-add-a-range-slider-to-filter-markers-without-shiny

```

## Incidents

<iframe class="map" src="https://safeyelli.ushahidi.io/views/map" frameborder="0" allowfullscreen data-external="1">

</iframe>

## Heatmap
Updated on 2/11/2021 7:17AM
```{r merging dataframes and creating sf frames}
allData <- rbind(oldHarassData,newHarassData)
allData <- rename(allData, lat=Location.lat, lng = Location.lon)

# Attach a coordinate reference 
allCoords <- allData %>%
  st_as_sf(coords = c('lng', 'lat'),crs = 4326)



```


```{r Mappinnng!, echo=FALSE, out.width='100%'}
#addProviderTiles(providers$CartoDB.Positron) not working
map <- leaflet(allCoords) %>%
  addTiles(urlTemplate = mapUrl) %>%
  fitBounds(77.554808, 13.087922, 77.608495, 13.114213) %>%
  setMaxBounds(77.554808, 13.087922, 77.608495, 13.114213) %>%
  
  addScaleBar() %>%
  addLayersControl(
    baseGroups = c("Heat Map", "Incident markers"),
    #overlayGroups = c("Empty Plots", "Dilipated infrastructure", "Shops"),
    options = layersControlOptions(collapsed = FALSE)
  ) %>%
  
  addMarkers(
    #label = allCoords$`Describe the incident in detail`,
    #labelOptions = labelOptions(textsize = "10px", width),
    popup = htmlEscape(allCoords$`Describe the incident in detail`),
    popupOptions = popupOptions(maxWidth = 400),
    #opacity=0.09,
    #fillColor = ~pal(`Year of Occurence`),
    clusterOptions = markerClusterOptions(),
    group = "Incident markers"
  ) %>%
  
  addHeatmap(
    radius = 20,
    blur = 20,
    intensity = 0.7,
    cellSize = 0.1,
    minOpacity = 0.8,
    max = 0.9,
    group = "Heat Map"
  )
# Layers
# addPolygons(data = emptyPlot,
#             color = 'grey',
#             stroke=FALSE,
#             label = emptyPlot$Name,
#             group="Empty Plots") %>%
# addPolygons(data = infrasPlot,
#             color = 'red',
#             stroke=FALSE,
#             label = infrasPlot$Name,
#             group="Dilipated infrastructure") %>%
# addPolygons(data = shopPlot,
#             color = 'green',
#             stroke=FALSE,
#             label = shopPlot$Name,
#             group="Shops")




# UI controls
# addLegend(pal=pal,
#          title="what is this",
#          values= ~`Year of Occurence`) %>%



map
```

### Usage {.tabset}

Use the selection tool on the right to shift between viewing a heat map and viewing precise incidents. Click on the circles while viewing precise incidents to read about it.

### Viewing status of infrastructure

You can use the checkboxes to enable and disable seeing the status of infrastructure around Yelahanka. Ill lit streets and parks are some of the infrastructure that would be mapped (InProgress)

</div>
# Why are we doing this?

We live in a scary place in time to have normalised harassment and catcalling. There seem to be too many stories from victims who happen to be predominantly young students. What could be some causal factors for this?  It is very likely that poorly maintained public infrastructure and inept policing strategies are the major causal factors for crime in our area. But there are deeper roots, what social factors cause these?

Situational crime prevention measures focus on the circumstances in which crime takes place, rather than on offenders. Keeping that in mind, strategies should be constructed limiting the opportunities for people to commit crime. 

**Of the many types of crime that are perpetrated, sexual assault, harassment and catcalling are more pronounced and have impacted a relatively larger demographic of our community.** Fortunately, adopting a proper crime prevention strategy can help curb the intensity and frequency of these crimes. Our objective is to gather enough data to present a credible case and influence effective prevention strategies on the basis of hard numbers.

Individuals with a higher propensity to commit crime might not be pushed over the edge, if we're able to successfully deny them the 'opportunity to commit crime.'

## What is the Dark Figure of crime?

The Dark Figure of crime is defined as the number of crimes not known or recorded by the police.

### How do we know this?

There is a significant difference in the number of crimes reported in police statistics and victim surveys. **Victim surveys tend to be a lot more open and don't require prolonged participation. More often than not, people don't report less serious offences, like catcalling, to the police because:**

1.  They don't know that a particular type of behaviour or action is a crime.

2.  They might be apprehensive of the protracted legal battle that will ensue.

3.  Sometimes, a family member might be the perpetrator.

Some studies by academics in India estimate the dark figure to be about 50 times higher than the official crime rates. It is only prudent to infer that the dark figure in the case of sexual assault and harassment is higher. The only way that we can paint a complete picture is to have multiple, credible and independent surveys that deal with the same specific problem(crime).

Essentially, if you want to feel safer and make your immediate living environment feel comfortable and secure, then the least you can do is report.

# Defining harassment and other terms 

(The law provides a clear enough definition of assault) 

1.  Assault: Whoever assaults or uses criminal force to any woman(or man\*), intending to outrage or knowing it to be likely that he will thereby outrage her modesty (Sec 354 IPC).

2.  Harassment:  Sexual harassment is unwanted behaviour of a sexual nature which: violates your dignity. makes you feel intimidated, degraded or humiliated. creates a hostile or offensive environment.

Section 506 IPC - criminal intimidation. (Reverse the gender roles and it still constitutes harassment. Women can also be reported under 506 - Criminal intimidation)\

Even though there is no 'catcalling' or 'eve teasing' law in India. People often use Sec 294 IPC in cases relating to such offences

3.  Obscene acts and songs.---Whoever, to the annoyance of others---

    \(a\) does any obscene act in any public place, or

    \(b\) sings, recites or utters any obscene song, ballad or words, in or near any public place \

# Telling your story

## Your reports are anonymous.

At no point are you asked for personally identifiable information.

## Why should you report?

> "Because it's on you to always do the right thing"

If you are being harassed, there are certain steps you can take to stop them. If you don't report it, they're just going to keep doing it. You now have the power to do something about it. Every report helps us paint a more comprehensive picture, essentially mapping these crimes in order to influence policing and public policy. 

## How can you help? 

> **"If you see something, do something"**

If you see sexual assault, harassment or catcalling happen to someone else or if something happens to you, go to the police and file a report. Additionally, take 5 minutes and fill out this form so that you can contribute to a larger cause with your story.

## Why does it matter? 

> **"Because If you don't do anything about it, you become complicit"**

As socially responsible human beings, it is our duty to do everything we can to make sure that the world is a safer place today than it was yesterday. Seems far fetched? Well, Let's start with making our immediate surroundings safe. Let's strive towards a society where a woman can walk down the street without fear of harassment!

# Report an incident

If you would to have your incident listed on this map, you can reach out to us to record your story. The map will be updated periodically.

<iframe width="100%" height="600" src="https://safeyelli.ushahidi.io/posts/create/1" frameborder="0" allowfullscreen data-external="1">

</iframe>
